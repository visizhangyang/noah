<ion-view class="user-login-modal" view-title="登录" cache-view="false">
  <ion-content>
    <form name="form"
          novalidate
          class="m-form">

      <div class="list margin-top">
        <ion-input class="item item-input item-send-code">
          <ion-label>手机号</ion-label>
          <input type="tel"
                 size="11"
                 ng-pattern="/^1[3|4|5|7|8][0-9]\d{8}$|^0{6}\d{5}$/"
                 ng-model="vm.user.phone"
                 name="uPhone"
                 placeholder="11位手机号码"
                 ng-change="vm.clearError(form)"
                 required>
        </ion-input>

        <ion-input class="item item-input">
          <ion-label>密码</ion-label>
          <input type="password"
                 ng-model="vm.user.password"
                 ng-pattern="/^(?=.*\d)(?=.*[a-zA-Z])\w{8,}$/"
                 name="password"
                 placeholder="至少8位，包含数字和字母"
                 ng-change="vm.clearError(form)"
                 required>
        </ion-input>
        <div class="error">
          <span ng-if="form.uPhone.$dirty && form.uPhone.$invalid && form.uPhone.$touched">
            手机号码格式不正确<span ng-if="form.password.$invalid && form.password.$touched">；</span>
          </span>
          <span ng-if="form.password.$dirty && form.password.$invalid && form.password.$touched">
            密码格式不对, 至少为8位，需同时包含数字和字母
          </span>
          <div ng-if="vm.submitError">
            <span>
              {{ vm.submitError }}
            </span>
          </div>
        </div>
      </div>

      <button class="button button-full button-positive margin-top"
              ng-disabled="form.$invalid"
              ng-click="vm.login($event, form.$valid)">
        登录
      </button>

      <div class="register-link">
        <a class="positive" ng-click="vm.goSignup()">
          注册账户
        </a>
        <a class="positive" ng-click="vm.goSMSLogin()">忘记密码</a>
      </div>
    </form>
  </ion-content>

</ion-view>
